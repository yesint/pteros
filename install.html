<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Pteros: Installation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pteros.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Pteros
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">Molecular modeling library for human beings!</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('install.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Installation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#port">Portability</a></li>
<li class="level1"><a href="#depend">Dependencies</a><ul><li class="level2"><a href="#pre">Prerequisites</a></li>
<li class="level2"><a href="#managed">Managed dependencies</a><ul><li class="level3"><a href="#req_dep">Required dependencies</a></li>
<li class="level3"><a href="#opt">Optional dependencies</a></li>
</ul>
</li>
<li class="level2"><a href="#ubuntu">Installing on Ubuntu</a></li>
</ul>
</li>
<li class="level1"><a href="#build">Building Pteros</a><ul><li class="level2"><a href="#get">Getting the code</a></li>
<li class="level2"><a href="#compile">Compiling</a><ul><li class="level3"><a href="#alt_compiler">Choosing compiler</a></li>
</ul>
</li>
<li class="level2"><a href="#ctrl">Controlling searching and donwloading of dependencies</a></li>
<li class="level2"><a href="#test">Testing installation</a></li>
<li class="level2"><a href="#gmx">Gromacs support</a></li>
<li class="level2"><a href="#python">Python support</a><ul><li class="level3"><a href="#no_pythin">Compiling without python</a></li>
<li class="level3"><a href="#module">Installing as a python module</a></li>
</ul>
</li>
<li class="level2"><a href="#standalone">Building standalone analysis plugins</a></li>
<li class="level2"><a href="#no_omp">Building without OpenMP</a></li>
<li class="level2"><a href="#sasa">SASA code</a></li>
</ul>
</li>
<li class="level1"><a href="#trouble">Reporting bugs</a><ul><li class="level2"><a href="#known_problems">Known problems</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="port"></a>
Portability</h1>
<p>Pteros is currently being developed on Linux Mint with gcc and clang compilers. Design decisions are made with portability to Linux, Windows and MacOS in mind but no testing on Windows and MacOS are made. Other systems were never considered. The code itself should be 100% portable providing that the dependencies are available for your system, but expect platform-dependent quirks and issues, which are common to all complex C++ programs, not only to Pteros.</p>
<dl class="section note"><dt>Note</dt><dd>If you managed to compile Pteros on MacOS, please share your experience because we have no Mac machines to perform the tests.</dd>
<dd>
You are wellcome to provide a guide for compiling Pteros on Windows. I maintained such guide some time ago but now I have no interest in this since I'm not doing any development on Windows.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Intel ICC compiler was tested in the past on Linux, but was giving poor performance. Compiling with Intel MKL worked, but gave broken Python bindings. No testing with recent versions was performed.</dd></dl>
<h1><a class="anchor" id="depend"></a>
Dependencies</h1>
<p>Current version of Pteros is 3.x. It depends on C++17 features and requires sufficiently modern compiler. If you are still limited by old compiler use branch v2 which is outdated but requires only C++11.</p>
<h2><a class="anchor" id="pre"></a>
Prerequisites</h2>
<p>These core dependencies should be installed <em>separately</em>:</p><ul>
<li>Standard-conforming C and C++17 compilers (tested with gcc&gt;=9.0, clang&gt;=10.0).</li>
<li><a href="http://www.cmake.org/">cmake</a> 3.10 or higher.</li>
<li><a href="http://www.boost.org/">boost</a> 1.50 or higher.</li>
<li><a href="http://git-scm.com/">Git</a> for getting the source code.</li>
<li><a href="https://www.python.org/">Python</a> 3.5 or higher (optional, needed for compiling dynamic plugins and python bindings).</li>
</ul>
<h2><a class="anchor" id="managed"></a>
Managed dependencies</h2>
<p>Pteros is able to download and compile most of its dependencies automatically, but could also used pre-installed libraries if they are found in the system. By default Pteros searches for pre-installed libraries first and if not found downloads and compiles them itself. This could be configured precisely if needed (see below).</p>
<h3><a class="anchor" id="req_dep"></a>
Required dependencies</h3>
<ul>
<li><a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen</a> linear algebra library (&gt;=3.2).</li>
<li><a href="https://github.com/fmtlib/fmt">fmt</a> Formatting library.</li>
<li><a href="https://github.com/gabime/spdlog">spdlog</a> Logging library.</li>
<li><a href="https://github.com/pybind/pybind11">Pybind11</a> binding generator library (optional, only needed for python bindings).</li>
</ul>
<h3><a class="anchor" id="opt"></a>
Optional dependencies</h3>
<ul>
<li><a href="http://www.gromacs.org/">Gromacs</a> version 2016.x or higher (for reading Gromacs TPR files and using Gromacs topologies).</li>
<li><a href="https://github.com/openbabel/openbabel">OpenBabel</a> version 2.4 or higher (for reading MOL2 and PDBQT files, performing substructure search, determinign molecular symmetry).</li>
<li><a href="www.doxygen.org">Doxygen</a> for building documentation.</li>
<li><a href="http://sphinx-doc.org/">Sphinx</a> for building documentation for Python bindings.</li>
</ul>
<h2><a class="anchor" id="ubuntu"></a>
Installing on Ubuntu</h2>
<p>If you are using latest Ubuntu or other debian-based system it should be enough to run the following command in the terminal to install basic dependencies:</p>
<div class="fragment"><div class="line">sudo apt-get install g++ cmake libeigen3-dev libboost-all-dev python3-dev python3-numpy pybind11-dev git doxygen python-sphinx</div>
</div><!-- fragment --><dl class="section warning"><dt>Warning</dt><dd>It is \i not recommended to use Gromacs and OpenBabel installed from repositories when compiling Pteros because they are not discovered correctly and may lead to weird errors, which are very hard to track. Use <code>-DTRY_SYSTEM_GROMACS=OFF -DTRY_SYSTEM_OPENBABEL=OFF</code>. Pteros will download and compile them itself.</dd></dl>
<h1><a class="anchor" id="build"></a>
Building Pteros</h1>
<h2><a class="anchor" id="get"></a>
Getting the code</h2>
<p>Get the latest source code from the Git repository: </p><div class="fragment"><div class="line">git clone https://github.com/yesint/pteros.git pteros</div>
</div><!-- fragment --><p> This will create a directory named "pteros" in you current working directory and will download the source code into it.</p>
<dl class="section note"><dt>Note</dt><dd>Use branch v2 if you need older version which compiles by C++11 compilers.</dd></dl>
<h2><a class="anchor" id="compile"></a>
Compiling</h2>
<p>Create a separate build directory (for example 'pteros_build'). Go to this directory and issue the following commands:</p>
<div class="fragment"><div class="line">cmake &lt;path to Pteros source directory&gt; -DCMAKE_INSTALL_PREFIX=&lt;where to install Pteros&gt;</div>
<div class="line">make</div>
<div class="line">make install</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Other available CMake options are discussed below. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The 'make install' command may require root access if you are installing into the system-wide location.</dd></dl>
<p>The cmake command will print something like this: </p><div class="fragment"><div class="line">------------------------------</div>
<div class="line">IMPORTANT!</div>
<div class="line">In order to be able to link with` Pteros and to use Pteros Python modules</div>
<div class="line">you have to source the pterosrc file in your bash shell:</div>
<div class="line">source /home/user/programs/pteros/lib/pterosrc</div>
<div class="line">------------------------------</div>
</div><!-- fragment --><p>Copy suggested line and add it to your .bashrc file (it is assumed that bash shell is used. If it is not the case use the syntax of your actual shell instead).</p>
<h3><a class="anchor" id="alt_compiler"></a>
Choosing compiler</h3>
<p>If you want to compile with alternative compiler (for example Clang), add the following flags to cmake invocation: </p><div class="fragment"><div class="line">-DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++</div>
</div><!-- fragment --><h2><a class="anchor" id="ctrl"></a>
Controlling searching and donwloading of dependencies</h2>
<p>The following CMake variables could be used: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Variable </th><th class="markdownTableHeadNone">Meaning  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">WITH_PYTHON </td><td class="markdownTableBodyNone">Build python bindings and compile analysis plugins as Python modules. Default: ON  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">WITH_OPENMP </td><td class="markdownTableBodyNone">Use OpenMP parallelization. Default: ON  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">WITH_OPENBABEL </td><td class="markdownTableBodyNone">Link to OpenBabel to read pdbqt files and for substructure search. Default: ON  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">WITH_GROMACS </td><td class="markdownTableBodyNone">Link to Gromacs to read tpr files. Default: ON  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">WITH_TNG </td><td class="markdownTableBodyNone">Link to TNG_IO library to read tng files. Default: ON  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">WITH_POWERSASA </td><td class="markdownTableBodyNone">Use bundled POWERSASA code. Default: ON  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TRY_SYSTEM_DEPENDENCIES </td><td class="markdownTableBodyNone">If OFF disables the searach for pre-installed libraries and downloads all dependencies.Default: ON  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">DOWNLOAD_DEPENDENCIES </td><td class="markdownTableBodyNone">Allow downloading and compiling dependencies. Default: ON  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TRY_SYSTEM_EIGEN </td><td class="markdownTableBodyNone">Try using system Eigen. Default: ON  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TRY_SYSTEM_FMT </td><td class="markdownTableBodyNone">Try using system fmt. Default: ON  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TRY_SYSTEM_SPDLOG </td><td class="markdownTableBodyNone">Try using system spdlog. Default: ON  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TRY_SYSTEM_PYBIND11 </td><td class="markdownTableBodyNone">Try using system pybind11. Default: ON  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TRY_SYSTEM_GROMACS </td><td class="markdownTableBodyNone">Try using system Gromacs. Default: ON  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TRY_SYSTEM_OPENBABEL </td><td class="markdownTableBodyNone">Try using system OpenBabel. Default: ON  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">GROMACS_SOURCE_DIR </td><td class="markdownTableBodyNone">Location of Gromacs sources in the system  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">GROMACS_BINARY_DIR </td><td class="markdownTableBodyNone">Location of Gromacs binaries in the system  </td></tr>
</table>
<p>Combining these variable one can control how each of dependencies is discovered in the system and downloaded if not found.</p>
<h2><a class="anchor" id="test"></a>
Testing installation</h2>
<p>Run the following command: </p><div class="fragment"><div class="line">pteros_analysis.py --help all</div>
</div><!-- fragment --><p>If you see any errors then Pteros can't load plugins or something elese went wrong.</p>
<dl class="section note"><dt>Note</dt><dd>This is only applicable if you are building with Python support!</dd></dl>
<h2><a class="anchor" id="gmx"></a>
Gromacs support</h2>
<p>Pteros could be linked against Gromacs. In this case it can read Gromacs TPR files and make advantage of Gromacs topologies.</p>
<p>Unfortunately Gromacs developers are changing the public API from one version to the other, while Pteros still needs some low-level facilities which are now no longer exposed in the installed headers. There are also bugs in some Gromacs versions, which prevents it from being discovered and imported normally in CMake. Due to all these complications linking with Gromacs becomes a bit more involved than it should be.</p>
<p>You have two options:</p><ul>
<li>Let Pteros download latest Gromacs version from git, compile the minimal static library and link it automatically. This is the simplest and the most reliable way, but it takes significant time to compile. It is used by default.</li>
<li>Use the pre-installed version of Gromacs. In this case in addition to normal Gromacs installation you need a source code matching \i exactly the version installed. You need to use the following CMake flags: <div class="fragment"><div class="line">-DWITH_GROMACS=ON -GROMACS_SOURCE_DIR=&lt;path to gromacs source tree&gt; -GROMACS_BINARY_DIR=&lt;path to installed gromacs with the &#39;lib&#39; folder inside&gt;</div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="python"></a>
Python support</h2>
<p>If both Python 3.x and 2.7 are installed in your system the version 3.x will be used automatically (even if 2.7 if the system-default, like in some older Ubuntu versions).</p>
<dl class="section note"><dt>Note</dt><dd>Make sure that you use correct python interpreter! Always use python3 with Pteros.</dd></dl>
<h3><a class="anchor" id="no_pythin"></a>
Compiling without python</h3>
<p>Pteros could be build without Python by specifying the following flag:</p>
<div class="fragment"><div class="line">-DWITH_PYTHON=&quot;OFF&quot; </div>
</div><!-- fragment --><p>In this case compiled C++ plugins are not built as python extension modules and python bindings are not built at all.</p>
<h3><a class="anchor" id="module"></a>
Installing as a python module</h3>
<p>It is also possible to install Pteros in "pythonic" way using pip. In this case you get Pteros as a normal python module installed correctly as any other python package, but you have no control on the compilation process (unless you edit the setup.py script).</p>
<p>Run the following command from the Pteros directory: </p><div class="fragment"><div class="line">pip3 install .</div>
</div><!-- fragment --><dl class="section warning"><dt>Warning</dt><dd>This method only works with python &gt;= 3.8.</dd></dl>
<h2><a class="anchor" id="standalone"></a>
Building standalone analysis plugins</h2>
<p>Analysis plugins, which are written in C++, are compiled as Python extensions by default. However, it is possible to build each plugin as a separate standalone program, which does not depend on Python, by adding the following flag to CMake:</p>
<div class="fragment"><div class="line">-DSTANDALONE_PLUGINS=ON </div>
</div><!-- fragment --><p>If you want to build plugins as the standalone programs AND as python extensions at the same time use the following flags: </p><div class="fragment"><div class="line">cmake &lt;usual options&gt; -DWITH_PYTHON=ON -DSTANDALONE_PLUGINS=ON</div>
<div class="line">make</div>
<div class="line">make install</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>In this case each plugin will be compiled twice, so expect longer compilation time.</dd></dl>
<h2><a class="anchor" id="no_omp"></a>
Building without OpenMP</h2>
<p>By default Pteros is compiled with OpenMP paralellization for many internal operations. However, on certain computational clusters the usage of OpenMP is prohibited. There are also other situations when you may want to disable OpenMP. Use the following flag to compile without OpenMP:</p>
<div class="fragment"><div class="line">cmake &lt;usual options&gt; -DWITH_OPENMP=OFF</div>
</div><!-- fragment --><h2><a class="anchor" id="sasa"></a>
SASA code</h2>
<p>Pteros performs the Solvent Accesible Surface Area (SASA) computatations using POWERSASA code developed in the <a href="http://www.kit.edu/english/">Karlsruhe Institute of Technology</a>. POWERSASA is licensed by specific and rather restrictive "Academic/Non-Profit SASA software license agreement". See the file <code>thirdparty/sasa/LICENSE</code> for details. This license is NOT Open Source and implies many restrictions. I contacted the authors of POWERSASA several times and asked for official permission to use their code but got no reply. It seems that the project is abandoned for a long time and nobody is concerned about the licensing of POWERSASA for many years. If you still don't want to use this code due to possible licensing concerns, you can swith it off: </p><div class="fragment"><div class="line">-DWITH_POWERSASA=OFF</div>
</div><!-- fragment --><h1><a class="anchor" id="trouble"></a>
Reporting bugs</h1>
<p>Use <a href="https://github.com/yesint/pteros/issues">issues on Github</a> to report bugs.</p>
<h2><a class="anchor" id="known_problems"></a>
Known problems</h2>
<ul>
<li>Linking with <code>libopenbabel-dev</code> installed from repositories fails in Ubuntu 16.x and 18.x due to corrupted headers in the package. Allow Pteros to download and compile OpenBabel instead.</li>
<li>Clang compiler doesn't work with Boost &lt; 1.52</li>
<li>OpenMP in clang only works for clang++ &gt;= 3.8 and if libomp is installed: <code>sudo apt-get install libomp-dev</code></li>
<li>If there are several Boost versions in the system CMake may find the right one for one library but the wrong one for the other, which causes very strange errors. The solution is to include the following flags to CMake invocation: <div class="fragment"><div class="line">-DBoost_NO_SYSTEM_PATHS=ON -DBOOST_ROOT=&quot;Correct path to boost&quot; </div>
</div><!-- fragment --></li>
<li>All Pteros plugins have to be up to date with the main library, but CMake doesn't always ensure this if you pull new updates from the repository. If plugins suddenly stop working after update delete CMakeCache.txt and CMakeFiles and recompile.</li>
<li>The error <em>"trying to overwrite '/usr/include/spdlog/async_logger.h', which is also in package libspdlog-dev 1.6-1"</em> occurs during installation. This happens if you have <code>spdlog</code> installed system-wide in Ubuntu from the package <code>libspdlog-dev</code>. This package is built in a wrong way and it lacks <code>spdlogConfig.cmake</code> file needed for correct library detection. That is why Pteros can't see it and tries to install its own bundled version of spdlog. Allow Pteros to download spdlog itself instead: <code>-DTRY_SYSTEM_SPDLOG=OFF</code>. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Jul 9 2022 15:59:59 for Pteros by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
